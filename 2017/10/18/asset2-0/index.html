<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge, chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="keywords" content="river,前端,设计,前端开发,用户体验,设计,frontend,design,nodejs,JavaScript"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="/css/style.css"><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><title>项目小记</title><body><div class="container"><div class="nav"><ul><li class="item"><a href="/">主页</a></li><li class="item"><a href="/archives">归档</a></li><li class="item"><a href="/about/">关于</a></li></ul></div><article><header><h1 class="title">项目小记</h1><i class="icon-calendar"></i><span>2017.10.18</span></header><div class="content"><p>经过一年密集的开发，工作负责的项目将在10月份结项，在这里做个总结，说下个人心得，另外类似的实现也可以参考我 Vue 全家桶实践项目 <a href="https://github.com/wsihe/vue-many" target="_blank" rel="external">vue-many</a>。</p>
<h2 id="前项目存在问题："><a href="#前项目存在问题：" class="headerlink" title="前项目存在问题："></a>前项目存在问题：</h2><ul>
<li>系统的交互流程复杂，以生成报告书为例，几乎所有流程集中在同一个页面，没有明显的流程次序区分，新用户难以上手。</li>
<li>交互流程不够方便快捷，交互方式指引不够——操作指引不清晰，用户在进行功能操作时，会错过一些处理，造成结果与用户预期不同。</li>
<li>界面设计较落后，老旧的系统样式—-为了后续能支持多终端，二期在界面设计上将以扁平化设计为主，多平台尽量保持一致。</li>
<li>代码比较混乱，原平台开发代码的逻辑是个坑，且踩且珍惜。</li>
</ul>
<p>旧系统是以前的老项目，存在的问题比较多。</p>
<h2 id="新项目的优化："><a href="#新项目的优化：" class="headerlink" title="新项目的优化："></a>新项目的优化：</h2><p>二期对整个项目进行了重构。</p>
<h4 id="技术栈"><a href="#技术栈" class="headerlink" title="技术栈"></a>技术栈</h4><p>首先在前端框架选择上，开发效率会在很大程度上影响技术选型。毕竟，开发效率在很大程度上决定了上线时间，上线时间很大地影响了技术选型。</p>
<ul>
<li>几周的时间做一个项目，首先想到的会是找一个模板demo。</li>
<li>几个月的时间做一个项目，会想到找一个框架。</li>
<li>几个年的时间来做一个网站，会想着造几个轮子，不过也限于技术范围内。</li>
</ul>
<p>快速的业务迭代， Vue 是不错的选择，不仅简单、容易上手、配置设施齐全，同时拥有完善的中文文档。<br>另外使用 Vue 我们仍然可以使用 熟悉的 HTML 和 CSS 来编写代码。并且 Vue 也使用了 Virtual DOM、Reactive 及组件化的思想，可以让我们集中精力于编写应用，而不是应用的性能。还引入了 Bootstrap，对于一个短期项目来说，bootstrap作为框架能够很好的支撑开发。</p>
<p>更多 Vue 的优势所在，可以关注 <a href="https://mp.weixin.qq.com/s?__biz=MzIwNjQwMzUwMQ==&amp;mid=2247484393&amp;idx=1&amp;sn=142b8e37dfc94de07be211607e468030&amp;chksm=9723612ba054e83db6622a891287af119bb63708f1b7a09aed9149d846c9428ad5abbb822294&amp;mpshare=1&amp;scene=23&amp;srcid=1117xibGjH860bGrbWS3TNT1#rd" target="_blank" rel="external">《Vue作者尤雨溪：Vue 2.0，渐进式前端解决方案》</a>。</p>
<h4 id="组件化"><a href="#组件化" class="headerlink" title="组件化"></a>组件化</h4><p>组件化开发是当前前端开发技术趋势，组件化的目标一是为了复用，二是为了分解降低复杂度。在我们项目中，随着功能的增加以及页面细节的优化，单个页面的js代码也轻易超过1千行，代码臃肿难以维护，另外随着人员的增加，过多人对同一块代码的进行修改，导致bug的可能性上加大。<br>所以我们就需要适当地将页面内不同单元划分成不同组件来实现，分而自治。另外，当不同页面包含有相同UI、逻辑交互的单元时，也应考虑将该单元抽离出来，封装成独立的组件，以方便复用。</p>
<p>团队缺少基础组件的沉淀，所以在开发公共的基础组件也比较关键，可以更专一的完成个人负责的业务，效率更高。</p>
<h4 id="页面间通信机制"><a href="#页面间通信机制" class="headerlink" title="页面间通信机制"></a>页面间通信机制</h4><p>每个页面各自负责自己的视图展现和业务逻辑，页面与页面之间相互独立，没有引用其他页面的实例对象，无法调用其他页面的具体方法。</p>
<p>父子组件通信：vue 父组件的数据需要通过 prop 才能下发到子组件中，要注意的就是Prop 是单向绑定的：当父组件的属性变化时，将传导给子组件，但是反过来不会。这是为了防止子组件无意间修改了父组件的状态，来避免应用的数据流变得难以理解。</p>
<p>兄弟组件通信：兄弟组件不能直接相互传送数据，此时可以将数据挂载在父组件中，由两个组件共享：如果组件需要数据渲染，则由父组件通过props传递给该组件；如果组件需要改变数据，则父组件传递一个改变数据的回调函数给该组件，并在对应事件中调用。</p>
<p>事件广播：是常用的组件间通信方案，改变数据的组件发起一个事件，使用数据的组件监听这个事件，在事件处理函数中改变视图或者做其他的操作。</p>
<p>简单的的组件沟通可以用传props和callback的方法实现，然而，随着项目规模的扩大，组件就会嵌套得越来越深，这时候使用这个方法就有点不太适合。全局事件可以让组件直接沟通，但频繁使用事件会让数据流动变得很乱。对此，有相应成熟的解决方案，比如Vuex（Redux的vue实现）、RxJS等，</p>
<h4 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h4><p>路由的一个重要特性是体现页面视图与浏览器URL地址的映射，默认实现采用了简单的映射方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">页面URL = /&#123;页面名称&#125;?&#123;页面参数查询字符串&#125;</div></pre></td></tr></table></figure>
<p>URL路由地址对于多Tab页框架系统不适用，页面跳转/切换不会影响到浏览器历史记录。<br>路由只体现在一级页面，二级子页面的跳转/切换不影响到路由地址，子页面视图状态与路由的映射，需要由父页面控制。比如容器页面默认显示哪个子页面，可由容器页面的页面参数指定，同时反应到页面url地址中。</p>
<p>单页路由的实现思路：<a href="http://web.jobbole.com/88424/" target="_blank" rel="external">《理解浏览器历史记录》</a></p>
<h4 id="问题和解决办法"><a href="#问题和解决办法" class="headerlink" title="问题和解决办法"></a>问题和解决办法</h4><p>项目中 Vue 组件封装的一个问题：项目未迁移到es6 + webpack开发构建方式，组件的html模板内容需要在js文件中拼凑，这种拼接字符串模板写法困难，而且限制只能使用 HTML 而不能使用预处理器，如 Jade 。因此用辅助的构建方法，来处理这类动态组件和复杂视图组件，以便在外部引用复杂的HTML结构。后面迁移到es6 + webpack 使用单文件组件，会有更高的效率。</p>
<p>项目中比较核心的功能就是生成报告书，即可以进行报告书的内容定制，预览最终生成的报告书，再到提供PDF下载，一开始的技术方案是前端提供用户填写的数据，在后端调用来生成报告书的 HTML，再通过iframe的方式插到视图中，最终通过 Python 操作生成 PDF。因为都是的静态HTML,这样做的缺点也比较明显就是报告书的每页会出现很多空白的情况，而且和前后端分离的模式也有点冲突。</p>
<p>改进后的方案是页面的预览和分割成多个页面（解决每页空白的情况）放在前端实现，后端再通过PhantomJS／Python的方式来取到预览的HTML再转换成PDF。新方案大大减少了预览的时间，直接去掉了在后端生成HTML再返回的过程，提高了整体效率。</p>
<h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>经过这次重构的实践和踩坑，对Vue框架有了更深刻的认识，也积累了很多公共组件的开发经验，组件化提升工作效率，让开发人员尽可能的专注于需求的实现。</p>
</div></article></div></body></head></html>