<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge, chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="keywords" content="river,前端,设计,前端开发,用户体验,设计,frontend,design,nodejs,JavaScript"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="/css/style.css"><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><title>学习 React 的一些笔记</title><body><div class="container"><div class="nav"><ul><li class="item"><a href="/">主页</a></li><li class="item"><a href="/archives">归档</a></li><li class="item"><a href="/about/">关于</a></li></ul></div><article><header><h1 class="title">学习 React 的一些笔记</h1><i class="icon-calendar"></i><span>2017.07.14</span></header><div class="content"><p>补充下前段时间学习 React 的一些笔记，Demo 放到了 <a href="https://github.com/wsihe/react-study" target="_blank" rel="external">react-study</a><br> <a id="more"></a></p>
<h3 id="HTML-模板"><a href="#HTML-模板" class="headerlink" title="HTML 模板"></a>HTML 模板</h3><p>React 页面模版：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html lang=&quot;en&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">	&lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">	&lt;title&gt;Title&lt;/title&gt;</div><div class="line">	&lt;script src=&quot;../build/react.js&quot;&gt;&lt;/script&gt;</div><div class="line">	&lt;script src=&quot;../build/react-dom.js&quot;&gt;&lt;/script&gt;</div><div class="line">	&lt;script src=&quot;../build/browser.min.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">	&lt;div id=&quot;example&quot;&gt;&lt;/div&gt;</div><div class="line">	&lt;script type=&quot;text/babel&quot;&gt;</div><div class="line">		//后面只贴这里的主要代码</div><div class="line">	&lt;/script&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<ul>
<li>react.js 是 React 的核心库</li>
<li>react-dom.js 是提供与 DOM 相关的功能</li>
<li>Browser.js 的作用是将 JSX 语法转为 JavaScript 语法 (线上放在服务器完成)</li>
</ul>
<h3 id="ReactDOM-render"><a href="#ReactDOM-render" class="headerlink" title="ReactDOM.render()"></a>ReactDOM.render()</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">ReactDOM.render(</div><div class="line">  &lt;div className=&quot;react&quot;&gt;hello,react&lt;/div&gt;,</div><div class="line">  document.getElementById(&quot;example&quot;)</div><div class="line">)</div></pre></td></tr></table></figure>
<p>ReactDOM.render 将模板转为 HTML 语言，并插入指定的 DOM 节点</p>
<h3 id="JSX-语法"><a href="#JSX-语法" class="headerlink" title="JSX 语法"></a>JSX 语法</h3><p>JSX 的语法：HTML 语言直接写在 JavaScript 语言之中，不加任何引号</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">ReactDOM.render(</div><div class="line">  &lt;div&gt;</div><div class="line">  &#123;</div><div class="line">    names.map(function (name) &#123;</div><div class="line">      return &lt;div&gt;Hello, &#123;name&#125;!&lt;/div&gt;</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">  &lt;/div&gt;,</div><div class="line">  document.getElementById(&apos;example&apos;)</div><div class="line">);</div></pre></td></tr></table></figure>
<p>JSX 的基本语法规则：</p>
<ul>
<li>遇到 HTML 标签（以 &lt; 开头），就用 HTML 规则解析；</li>
<li>遇到代码块（以 { 开头），就用 JavaScript 规则解析</li>
</ul>
<h3 id="React-组件"><a href="#React-组件" class="headerlink" title="React 组件"></a>React 组件</h3><p>React 可以将代码封装成组件（component），然后像插入普通 HTML 标签一样，在网页中插入这个组件<br>React.createClass 方法就用于生成一个组件类</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">var HtmlCompent = React.createClass(&#123;</div><div class="line">  render:function () &#123;</div><div class="line">    return (</div><div class="line">      &lt;div&gt;</div><div class="line">    	&lt;h1&gt;hello,&#123;this.props.name&#125;&lt;/h1&gt;</div><div class="line">    	&lt;ol&gt;</div><div class="line">    	&#123;</div><div class="line">    	  React.Children.map(this.props.children, function (child) &#123;</div><div class="line">    	    return &lt;li&gt;&#123;child&#125;&lt;/li&gt;;</div><div class="line">    	  &#125;)</div><div class="line">    	&#125;</div><div class="line">    	&lt;/ol&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line">ReactDOM.render(</div><div class="line">  &lt;HtmlCompent name=&quot;react&quot;&gt;</div><div class="line">  	&lt;span&gt;hello&lt;/span&gt;</div><div class="line">  	&lt;span&gt;world&lt;/span&gt;</div><div class="line">  &lt;/HtmlCompent&gt;,</div><div class="line">  document.getElementById(&quot;example&quot;)</div><div class="line">);</div></pre></td></tr></table></figure>
<ul>
<li>组件类都必须有自己的 render 方法</li>
<li>组件类的第一个字母必须大写，否则会报错，HtmlCompent</li>
<li>组件类只能包含一个顶层标签，否则也会报错。</li>
<li>组件的属性可以在组件类的 this.props 对象上获取；this.props.name</li>
<li>添加组件属性：class 属性需要写成 className ，for 属性需要写成 htmlFor（JavaScript 保留字）</li>
<li>this.props.children：组件的所有子节点，值有三种可能<ol>
<li>当前组件没有子节点，它就是 undefined</li>
<li>有一个子节点，数据类型是 object</li>
<li>有多个子节点，数据类型就是 array</li>
</ol>
</li>
<li>this.props.children 用 React.Children 来处理，React.Children.map 来遍历子节点</li>
</ul>
<h3 id="PropTypes-amp-amp-获取真实的DOM节点"><a href="#PropTypes-amp-amp-获取真实的DOM节点" class="headerlink" title="PropTypes &amp;&amp; 获取真实的DOM节点"></a>PropTypes &amp;&amp; 获取真实的DOM节点</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">var Htmlcompent = React.createClass(&#123;</div><div class="line">  propTypes:&#123;</div><div class="line">    name:React.PropTypes.string.isRequired</div><div class="line">  &#125;,</div><div class="line">  getDefaultProps : function () &#123;</div><div class="line">      return &#123;</div><div class="line">        name : &apos;react&apos;</div><div class="line">      &#125;;</div><div class="line">  &#125;,</div><div class="line">  handleClick:function () &#123;</div><div class="line">	his.refs.myInput.focus()</div><div class="line">  &#125;,</div><div class="line">  render:function () &#123;</div><div class="line">	return (</div><div class="line">	  &lt;div&gt;</div><div class="line">		&lt;h1&gt; hello, &#123;this.props.name&#125;&lt;/h1&gt;</div><div class="line">		&lt;input type=&quot;text&quot; ref=&quot;myInput&quot;/&gt;</div><div class="line">		&lt;input type=&quot;button&quot; value=&quot;11111&quot; onClick=&#123;this.handleClick&#125;/&gt;</div><div class="line">	  &lt;/div&gt;</div><div class="line">	);</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line">ReactDOM.render(</div><div class="line">  &lt;Htmlcompent name=&quot;react&quot;/&gt;,</div><div class="line">  document.getElementById(&quot;example&quot;)</div><div class="line">);</div></pre></td></tr></table></figure>
<ul>
<li>组件类的PropTypes属性，就是用来验证组件实例的属性是否符合要求</li>
<li>getDefaultProps 方法可以用来设置组件属性的默认值；</li>
<li>用到 ref 属性，从组件获取真实 DOM 的节点，this.refs.[refName]</li>
</ul>
<p>this.refs.[refName] 属性获取的是真实 DOM ，所以必须等到虚拟 DOM 插入文档以后，才能使用</p>
<h3 id="this-state-amp-amp-表单"><a href="#this-state-amp-amp-表单" class="headerlink" title="this.state &amp;&amp; 表单"></a>this.state &amp;&amp; 表单</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">var Htmlcomponent = React.createClass(&#123;</div><div class="line">  getInitialState: function() &#123;</div><div class="line">	return &#123;value: &apos;React!&apos;&#125;;</div><div class="line">  &#125;,</div><div class="line">  handleChange: function(event) &#123;</div><div class="line">	this.setState(&#123;value: event.target.value&#125;);</div><div class="line">  &#125;,</div><div class="line">  render: function () &#123;</div><div class="line">	var value = this.state.value;</div><div class="line">	return (</div><div class="line">	  &lt;div&gt;</div><div class="line">		&lt;input type=&quot;text&quot; value=&#123;value&#125; onChange=&#123;this.handleChange&#125; /&gt;</div><div class="line">		&lt;p&gt;&#123;value&#125;&lt;/p&gt;</div><div class="line">	  &lt;/div&gt;</div><div class="line">	);</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line">ReactDOM.render(&lt;Htmlcomponent/&gt;, document.body);</div></pre></td></tr></table></figure>
<ol>
<li>getDefaultProps()<br>设置默认的props，也可以用dufaultProps设置组件的默认属性。</li>
<li>getInitialState()<br>在使用es6的class语法时是没有这个钩子函数的，可以直接在constructor中定义this.state。此时可以访问this.props。</li>
<li>render()<br>react最重要的步骤，创建虚拟dom，进行diff算法，更新dom树都在此进行。此时就不能更改state了。</li>
</ol>
<h3 id="组件的生命周期"><a href="#组件的生命周期" class="headerlink" title="组件的生命周期"></a>组件的生命周期</h3><p>组件的生命周期分成三个状态：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Mounting：已插入真实 DOM</div><div class="line">Updating：正在被重新渲染</div><div class="line">Unmounting：已移出真实 DOM</div></pre></td></tr></table></figure></p>
<p>React 为每个状态都提供了两种处理函数，will 函数在进入状态之前调用，did 函数在进入状态之后调用，三种状态共计五种处理函数:</p>
<ol>
<li>componentWillMount()<br>组件初始化时只调用，以后组件更新不调用，整个生命周期只调用一次，此时可以修改state。</li>
<li>componentDidMount()<br>组件渲染之后调用，可以通过this.getDOMNode()获取和操作dom节点，只调用一次。</li>
<li>componentWillUpdate(nextProps, nextState)<br>组件初始化时不调用，只有在组件将要更新时才调用，此时可以修改state</li>
<li>componentDidUpdate()<br>组件初始化时不调用，组件更新完成后调用，此时可以获取dom节点。</li>
<li>componentWillUnmount()<br>组件将要卸载时调用，一些事件监听和定时器需要在此时清除。</li>
</ol>
<p>React 还提供两种特殊状态的处理函数:</p>
<ol>
<li>componentWillReceivePorps(nextProps)<br>组件初始化时不调用，组件接受新的props时调用。</li>
<li>shouldComponentUpdate(nextProps, nextState)<br>react性能优化非常重要的一环。组件接受新的state或者props时调用，我们可以设置在此对比前后两个props和state是否相同，如果相同则返回false阻止更新，因为相同的属性状态一定会生成相同的dom树，这样就不需要创造新的dom树和旧的dom树进行diff算法对比，节省大量性能，尤其是在dom结构复杂的时候。不过调用this.forceUpdate会跳过此步骤。</li>
</ol>
</div></article></div></body></head></html>